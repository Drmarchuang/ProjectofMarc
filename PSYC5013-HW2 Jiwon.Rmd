---
title: "PSYC5013-HW2"
author:
- created by Dingjing Shi
- completed by Jiwon Song
date: "2/11/2021"
output:
  pdf_document: default
  html_document: default
---

# Question 1 (9 points in total)
## Covariance and correlation
### The Vocabulary.txt data attached in the assignment is a vocabulary data from the US General Social Surveys. Source of the data is downloaded from [source](http://sda.berkeley.edu/archive.htm). This data will be used for Questions 1 and 2 in Homework 2. Please read in the data and answer the questions below.
### The variable "education" represents education received in years, and the variable "vocabulary" represents the vocabulary-test score, with number of questions being answered correctly out of 10. Both are seen as continuous variables.
```{r echo=TRUE}

data <- Vocabulary.txt
names(data)=c('id','year','sex','education','vocabulary') 
attach(data)
```

## 1.1. What is the covariance between education and vocabulary variables? Use R function to compute. (3 points)
```{r echo=TRUE}
cov(education, vocabulary)

```
## 1.2. Sam wanted to interpret the correlation between the two variables. However, he found that all R functions in his computer were currently down and he weren’t able to use any R function. He can still use the arithmetic calculations in R. Suppose that Sam’s roomates told him that the **variances** for education and vocabulary are 9.25 and 4.69, respectively. Given information from 1.1 and 1.2, can you help Sam get the correlation of the two variables? (3 points)
```{r echo=TRUE}
cov(education, vocabulary)/(9.25*4.69)
```


## 1.3. What is the relation between correlation and covariance? (3 points)
### Your answer: correlation is the ratio of the covariance to the population standard deviations.
cov(education,vocabulary)/(sd(education)*sd(vocbulary)==cor(education,vocabulary)


# Question 2 (15 points in total)
## Hypothesis testing in simple regression
### Dr. Black is interested in knowing whether one's vocabulary score can predict one's year of education received and built a following regression model $education=\beta_{0}+\beta_{1}\times vocabulary+\epsilon$. Please follow each sub-questions below to conduct a hypothesis test of regression slope $\beta_{1}$ for the regression analysis.

## 2.1. Run the regression analysis in R, using the Vocabulary.txt data (1 point)
```{r echo=TRUE}
model1 <- lm(education~vocabulary, data=data)
summary(model1)

```
### The test statistic for $\beta_{1}$ is $t=\frac{b_{1}-\beta_{1}}{SE(b_{1})}$, where $SE(b_{1})=\sqrt(\frac{S_{E}^2}{\Sigma(x_{i}-x\bar)^2})$.

## 2.2. What does S_{E} in the numerator of SE(b_{1}) represent? Without directly using the lm() summary output, can you comopute the S_{E}? (3 points)
```{r echo=TRUE}
##It represents standard error, or residual standard error
sigma(model1)
```

## 2.3. Please mannually compute the SE(b_{1}) (3 points)
```{r echo=TRUE}
(sqrt(sigma(model1)^2/(var(vocabulary)*21638)))

```

## 2.4. Call the slope estimate from 2.1, and use SE(b_{1}) results from 2.2 and 2.3 to manually compute the t value for b_{1} (2 points)
```{r echo=TRUE}
coefficients(model1)[2]/(sqrt(sigma(model1)^2/(var(vocabulary)*21638)))
```

## 2.5. Compute the critical value with $\alpha=0.05$. Decide on your own the degrees of freedom in the study. (2 points)
```{r echo=TRUE}
qt(0.975, 21636)
round(qt(0.975,21636),2)
```
## 2.6 Make a decision and use APA style to interpret the results. Keep results in 3 decimal places. (4 points)
### Your answer:
To predict one's year of education received from one's vocabulary score, a simple regression analysis was conducted. The result of this analysis showed that the vocabulary score is statistically significant of one's year of education received (b=0.701906, t(21638)=84.88, p<0.05). The result indicated that individual with higher vocabulary scores are expected to have received more years of education



# Question 3 (8 points in total)
## Prediction
### To look at the relationship between the average speed of cars on the freeway (Y) and the number of patrol cars deployed (X), a following regression model was built and estimated. Speed (mph) = 85-5*cars. Please help a non-quantitative major understand / interpret the model.

## 3.1. What is your interpretation of $b_{0}=85?$ (3 points)
### Your answer: average of speed of cars is 85 mph when patrol car deployed is zero



## 3.2	With one more patrol car deployed, the average speed of cars on the freeway is expected to ______ (increase or decrease or change) by ___ (fill in an integer value) mph. (2 points in total, 1 point for each blank)
### Your answer: It will decrese by 5mph for one more patrol deployed 

## 3.3. Based on the regression model, for an average speed of 60mph, how many patrol cars are expected to be deployed? (2 points)
```{r echo=TRUE}
## 60=85-5*(Cars)
## 5 cars are expected to be deployed for an average speed of 60 mph
```
# Question 4 (2 points in total)
### True or False Question
## 4.1. Correlation implies causation.
### Your answer: No

## 4.2. Correlation looks at the linear or the non-linear relationships between variables. 
### Your answer: No


# Question 5 (6 points in total)
### Confidence interval calculation
## 5.1 Using output from 2.1, mannually compute the 95% confidence interval for $beta_{1}$. (4 points)
```{r echo=TRUE}
qt(0.975, 21636)
summary(model1)$coefficients[1,1]+qt(0.975, 21636)*summary(model1)$coefficients[1,2]

summary(model1)$coefficients[1,1]-qt(0.975, 21636)*summary(model1)$coefficients[1,2]


```

## 5.2 Use a function in R to compute the 95% confidence interval for $beta_{1}$. (2 points)
```{r echo=TRUE}
confint(model1)
```